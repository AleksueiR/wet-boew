/*! HTML5 sessionStorage
 * @build		2009-08-20 23:35:12
 * @author		Andrea Giammarchi
 * @license	Mit Style License
 * @project	http://code.google.com/p/sessionstorage/
 */
"undefined"==typeof sessionStorage&&function(e){function t(){function t(){u.cookie=["sessionStorage="+e.encodeURIComponent(s=a.key(128))].join(";"),r=a.encode(s,r),o=new o(i,"name",i.name)}var n,u=(i.name,i.document),d=/\bsessionStorage\b=([^;]+)(;|$)/,h=d.exec(u.cookie);if(h){s=e.decodeURIComponent(h[1]),r=a.encode(s,r),o=new o(i,"name");for(var p=o.key(),n=0,f=p.length,m={};f>n;++n)0===(h=p[n]).indexOf(r)&&(l.push(h),m[h]=o.get(h),o.del(h));if(o=new o.constructor(i,"name",i.name),(this.length=l.length)>0){for(n=0,f=l.length,c=o.c,h=[];f>n;++n)h[n]=c.concat(o._c,o.escape(p=l[n]),c,c,(p=o.escape(m[p])).length,c,p);i.name+=h.join("")}}else t(),d.exec(u.cookie)||(l=null)}var i=e;try{for(;i!==i.top;)i=i.top}catch(n){}/** RC4 Stream Cipher
 *	http://www.wisdom.weizmann.ac.il/~itsik/RC4/rc4.html
 * -----------------------------------------------
 * @description	A quick stream cipher object able to encode
 *					or decode whatever string using
 *					a random key from lennght 1 to 256
 *
 * @author			this JavaScript porting by Andrea Giammarchi
 * @license		Mit Style License
 * @blog			http://webreflection.blogspot.com/
 * @version		1.1
 * @compatibility	hopefully every browser
 */
var a=function(e,t){return{decode:function(e,t){return this.encode(e,t)},encode:function(t,i){for(var n,a=t.length,o=i.length,s=[],r=[],l=0,c=0,u=0,d=0;256>l;++l)r[l]=l;for(l=0;256>l;++l)c=(c+(n=r[l])+t.charCodeAt(l%a))%256,r[l]=r[c],r[c]=n;for(c=0;o>u;++u)l=u%256,c=(c+(n=r[l]))%256,a=r[l]=r[c],r[c]=n,s[d++]=e(i.charCodeAt(u)^r[(a+n)%256]);return s.join("")},key:function(i){for(var n=0,a=[];i>n;++n)a[n]=e(1+(255*t()<<0));return a.join("")}}}(e.String.fromCharCode,e.Math.random),o=function(e){function t(e,t,i){this._i=(this._data=i||"").length,(this._key=t)?this._storage=e:(this._storage={_key:e||""},this._key="_key")}function i(e,t){var i=this.c;return i.concat(this._c,this.escape(e),i,i,(t=this.escape(t)).length,i,t)}return t.prototype.c=String.fromCharCode(1),t.prototype._c=".",t.prototype.clear=function(){this._storage[this._key]=this._data},t.prototype.del=function(e){var t=this.get(e);null!==t&&(this._storage[this._key]=this._storage[this._key].replace(i.call(this,e,t),""))},t.prototype.escape=e.escape,t.prototype.get=function(e){var t=this._storage[this._key],i=this.c,n=t.indexOf(e=i.concat(this._c,this.escape(e),i,i),this._i),a=null;return n>-1&&(n=t.indexOf(i,n+e.length-1)+1,a=t.substring(n,n=t.indexOf(i,n)),a=this.unescape(t.substr(++n,a))),a},t.prototype.key=function(){for(var e=this._storage[this._key],t=this.c,i=t+this._c,n=this._i,a=[],o=0,s=0;(n=e.indexOf(i,n))>-1;)a[s++]=this.unescape(e.substring(n+=2,o=e.indexOf(t,n))),n=e.indexOf(t,o)+2,o=e.indexOf(t,n),n=1+o+1*e.substring(n,o);return a},t.prototype.set=function(e,t){this.del(e),this._storage[this._key]+=i.call(this,e,t)},t.prototype.unescape=e.unescape,t}(e);/** HTML5 sessionStorage cross-browser implementation
 * @description	sessionStorage object is an HTML5 working draft
 *					which aim is to remove cookie limits.
 *					Using a sort of "de-facto" standard as window.name
 *					behavior is, it is possible to implement the
 *					sessionStorage object in old browsers.
 *					The concept is that window.name persists in the tab,
 *					whatever page we are surfing, while as security measure
 *					I combined browser cookie management plus RC4 stream cipher
 *					in order to reduce security problems as much as possible.
 *
 * @author			Andrea Giammarchi
 * @license		Mit Style License
 * @blog			http://webreflection.blogspot.com/
 * @version		1.4
 * @compatibility	Android, Chrome, Explorer, Opera, unobtrusive for other browsers
 * @credits		W3 WebStorage Draft	http://dev.w3.org/html5/webstorage/
 *					RC4 Stream Cipher		http://www.wisdom.weizmann.ac.il/~itsik/RC4/rc4.html
 * @protocol		Linear String Storage, by the @author
 */
"[object Opera]"===Object.prototype.toString.call(e.opera)&&(history.navigationMode="compatible",o.prototype.escape=e.encodeURIComponent,o.prototype.unescape=e.decodeURIComponent),t.prototype={length:0,key:function(e){if("number"!=typeof e||0>e||e>=l.length)throw"Invalid argument";return l[e]},getItem:function(e){if(e=r+e,d.call(u,e))return u[e];var t=o.get(e);return null!==t&&(t=u[e]=a.decode(s,t)),t},setItem:function(e,t){this.removeItem(e),e=r+e,o.set(e,a.encode(s,u[e]=""+t)),this.length=l.push(e)},removeItem:function(e){var t=o.get(e=r+e);null!==t&&(delete u[e],o.del(e),this.length=l.remove(e))},clear:function(){o.clear(),u={},l.length=0}};var s,r=i.document.domain,l=[],u={},d=u.hasOwnProperty;l.remove=function(e){var t=this.indexOf(e);return t>-1&&this.splice(t,1),this.length},l.indexOf||(l.indexOf=function(e){for(var t=0,i=this.length;i>t;++t)if(this[t]===e)return t;return-1}),i.sessionStorage&&(t=function(){},t.prototype=i.sessionStorage),t=new t,null!==l&&(e.sessionStorage=t)}(window);